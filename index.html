<!DOCTYPE html>
<html>
<head>
  <title>ProofHub Projects</title>
  <style>
    table, th, td {
      border: 1px solid black; border-collapse: collapse; padding: 5px;
    }
    .column { float: left; width: 45%; margin: 10px; }
    .clearfix::after { content: ""; clear: both; display: table; }
  </style>
</head>
<body>
  <div class="clearfix">
    <div class="column">
      <h2>All Projects</h2>
      <table id="projectsTable"></table>
    </div>

    <div class="column">
      <h2>Project Detail</h2>
      <input type="text" id="projectId" placeholder="Enter Project ID">
      <button onclick="getProjectById()">Submit</button>
      <table id="projectDetailTable"></table>
    </div>
  </div>

  <script>
    const scriptBaseUrl = 'https://script.google.com/macros/s/AKfycby5Fr7sqmRYJCPZQSoUU_-R1PM4bMIUbJJd_7D7LLYZ8vMDBLKExmz7Wot0nlXiE-zC5A/exec';

    async function fetchProjects() {
      const response = await fetch(scriptBaseUrl);
      const projects = await response.json();
      renderTable(projects, document.getElementById('projectsTable'));
    }

    async function getProjectById() {
      const id = document.getElementById('projectId').value.trim();
      if (!id) return;
      const response = await fetch(`${scriptBaseUrl}?projectId=${id}`);
      const project = await response.json();
      renderTable([project], document.getElementById('projectDetailTable'));
    }

    function renderTable(data, table) {
      table.innerHTML = '';
      const headers = ['id', 'title', 'start_date', 'end_date', 'status', 'tabs', 'default_tab', 'assigned', 'category', 'manager', 'category_name'];
      const thead = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>';
      const rows = data.map(item => {
        return '<tr>' + headers.map(h => `<td>${formatValue(item[h])}</td>`).join('') + '</tr>';
      }).join('');
      table.innerHTML = thead + rows;
    }

    function formatValue(value) {
      if (Array.isArray(value)) return value.map(v => JSON.stringify(v)).join(', ');
      if (typeof value === 'object' && value !== null) return JSON.stringify(value);
      return value ?? '';
    }

    fetchProjects();
  </script>
</body>
</html>
